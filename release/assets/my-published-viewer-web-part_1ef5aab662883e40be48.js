define(["react","react-dom","@microsoft/sp-core-library","@microsoft/sp-property-pane","@microsoft/sp-webpart-base","@microsoft/sp-http"],(e,t,n,a,i,r)=>(()=>{"use strict";var o={9676:e=>{e.exports=n},1909:e=>{e.exports=r},9877:e=>{e.exports=a},6642:e=>{e.exports=i},5959:t=>{t.exports=e},8398:e=>{e.exports=t}},s={};function c(e){var t=s[e];if(void 0!==t)return t.exports;var n=s[e]={exports:{}};return o[e](n,n.exports,c),n.exports}c.d=(e,t)=>{for(var n in t)c.o(t,n)&&!c.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},c.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),c.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var d={};return(()=>{c.r(d),c.d(d,{default:()=>h});var e,t=c(5959),n=c(8398),a=c(9676),i=c(9877),r=c(6642),o=c(1909),s=(e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)},function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}),l=function(e,t,n,a){return new(n||(n=Promise))(function(i,r){function o(e){try{c(a.next(e))}catch(e){r(e)}}function s(e){try{c(a.throw(e))}catch(e){r(e)}}function c(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n(function(e){e(t)})).then(o,s)}c((a=a.apply(e,t||[])).next())})},u=function(e,t){var n,a,i,r,o={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return r={next:s(0),throw:s(1),return:s(2)},"function"==typeof Symbol&&(r[Symbol.iterator]=function(){return this}),r;function s(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;o;)try{if(n=1,a&&(i=2&r[0]?a.return:r[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,r[1])).done)return i;switch(a=0,i&&(r=[2&r[0],i.value]),r[0]){case 0:case 1:i=r;break;case 4:return o.label++,{value:r[1],done:!1};case 5:o.label++,a=r[1],r=[0];continue;case 7:r=o.ops.pop(),o.trys.pop();continue;default:if(!((i=(i=o.trys).length>0&&i[i.length-1])||6!==r[0]&&2!==r[0])){o=0;continue}if(3===r[0]&&(!i||r[1]>i[0]&&r[1]<i[3])){o.label=r[1];break}if(6===r[0]&&o.label<i[1]){o.label=i[1],i=r;break}if(i&&o.label<i[2]){o.label=i[2],o.ops.push(r);break}i[2]&&o.ops.pop(),o.trys.pop();continue}r=t.call(e,o)}catch(e){r=[6,e],a=0}finally{n=i=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}},f=function(e,t,n){if(n||2===arguments.length)for(var a,i=0,r=t.length;i<r;i++)!a&&i in t||(a||(a=Array.prototype.slice.call(t,0,i)),a[i]=t[i]);return e.concat(a||Array.prototype.slice.call(t))},p={DocIcon:"Type",FileLeafRef:"Name",Status:"Status",TitleName:"Title Name",Abstract:"Abstract",BusinessUnit:"Business Unit",Department:"Department",Region:"Region",Client:"Client",DocumentType:"Document Type",DiseaseArea:"Disease Area",TherapyArea:"Therapy Area",TimeStamp:"Time Stamp",KMCorrections:"KM Corrections",KMComments:"KM Comments",Reviewed:"Reviewed"};const m=function(e){function n(t){var n=e.call(this,t)||this;return n.state={items:[],loading:!0,expandedCols:[],hoverCol:void 0},n}return s(n,e),n.prototype.getColumnWidth=function(e){return"Abstract"===e?{width:"600px",minWidth:"400px",maxWidth:"600px"}:"FileLeafRef"===e||"TitleName"===e?{width:"400px",minWidth:"250px",maxWidth:"400px"}:"KMCorrections"===e||"KMComments"===e?{width:"500px",minWidth:"300px",maxWidth:"500px"}:{width:"200px",minWidth:"150px",maxWidth:"300px"}},n.prototype.componentDidMount=function(){return l(this,void 0,void 0,function(){return u(this,function(e){switch(e.label){case 0:return[4,this.loadItems()];case 1:return e.sent(),[2]}})})},n.prototype.getCurrentUserId=function(){return l(this,void 0,void 0,function(){var e;return u(this,function(t){switch(t.label){case 0:return[4,this.props.context.spHttpClient.get("".concat(this.props.context.pageContext.web.absoluteUrl,"/_api/web/currentuser"),o.SPHttpClient.configurations.v1)];case 1:if(!(e=t.sent()).ok)throw new Error("Failed to get current user: ".concat(e.status," ").concat(e.statusText));return[4,e.json()];case 2:return[2,t.sent().Id]}})})},n.prototype.loadItems=function(){return l(this,void 0,void 0,function(){var e,t,n,a,i,r,s,c,d,l;return u(this,function(u){switch(u.label){case 0:return u.trys.push([0,6,,7]),e=this.props.context.pageContext.web.absoluteUrl,t="","myDocuments"!==this.props.mode?[3,2]:[4,this.getCurrentUserId()];case 1:return n=u.sent(),t="PerformedBy/Id eq ".concat(n),[3,3];case 2:t="Status eq 'Published'",u.label=3;case 3:return a=(this.props.columns||"").split(",").map(function(e){return e.trim()}).filter(function(e){return e}),i=["Id","PerformedBy/Id","PerformedBy/Title"],-1!==a.indexOf("FileLeafRef")&&i.push("FileRef"),r=Array.from(new Set(f(f([],a,!0),i,!0))).join(","),s="".concat(e,"/_api/web/lists/getbytitle('").concat(this.props.listTitle,"')/items")+"?$select=".concat(r)+"&$expand=PerformedBy"+"&$filter=".concat(encodeURIComponent(t))+"&$orderby=Modified desc",[4,this.props.context.spHttpClient.get(s,o.SPHttpClient.configurations.v1)];case 4:if(!(c=u.sent()).ok)throw new Error("Failed to load items: ".concat(c.status," ").concat(c.statusText));return[4,c.json()];case 5:return d=u.sent(),this.setState({items:d.value||[],loading:!1}),[3,7];case 6:return l=u.sent(),console.error("Error loading items:",l),this.setState({items:[],loading:!1}),[3,7];case 7:return[2]}})})},n.prototype.toggleExpandColumn=function(e){this.setState(function(t){var n=new Set(t.expandedCols||[]);return n.has(e)?n.delete(e):n.add(e),{expandedCols:Array.from(n)}})},n.prototype.render=function(){var e=this,n=this.state,a=n.items,i=n.loading,r=n.expandedCols,o=n.hoverCol,s=(this.props.columns||"").split(",").map(function(e){return e.trim()}).filter(function(e){return e});return t.createElement("div",{style:{overflowX:"auto",width:"100%"}},i&&t.createElement("div",null,"Loading..."),!i&&0===a.length&&t.createElement("div",null,"No documents found."),!i&&a.length>0&&t.createElement("table",{style:{width:"100%",borderCollapse:"collapse"}},t.createElement("thead",null,t.createElement("tr",null,s.map(function(n){var a=o===n,i=r&&-1!==r.indexOf(n);return t.createElement("th",{key:n,onMouseEnter:function(){return e.setState({hoverCol:n})},onMouseLeave:function(){return e.setState({hoverCol:void 0})},style:{textAlign:"center",borderBottom:"1px solid #ccc",padding:"8px",whiteSpace:"nowrap",position:"relative"}},t.createElement("div",{style:{display:"flex",alignItems:"center",justifyContent:"center"}},t.createElement("span",null,p[n]||n),t.createElement("button",{title:i?"Collapse column":"Expand column",onClick:function(t){t.stopPropagation(),e.toggleExpandColumn(n)},style:{marginLeft:6,display:a?"inline-block":"none",border:"none",background:"transparent",cursor:"pointer",padding:2,lineHeight:1}},i?"▾":"▸")))}))),t.createElement("tbody",null,a.map(function(n){return t.createElement("tr",{key:n.Id},s.map(function(a){var i=e.getColumnWidth(a),r={padding:"12px",borderBottom:"1px solid #eee",textAlign:"center",verticalAlign:"top",whiteSpace:"pre-wrap",width:i.width,minWidth:i.minWidth,maxWidth:i.maxWidth,minHeight:"Abstract"===a?"100px":"FileLeafRef"===a||"TitleName"===a?"80px":"60px",maxHeight:"none",wordWrap:"break-word",overflowWrap:"break-word",lineHeight:"1.6"},o={lineHeight:"1.6",wordWrap:"break-word",overflowWrap:"break-word",maxWidth:"100%",whiteSpace:"pre-wrap",textAlign:"center"};return t.createElement("td",{key:a,style:r},"FileLeafRef"===a&&n.FileRef?t.createElement("div",{style:o},t.createElement("a",{href:n.FileRef,target:"_blank",rel:"noreferrer",style:{color:"inherit",textDecoration:"underline",cursor:"pointer",wordWrap:"break-word",overflowWrap:"break-word"}},n[a]?n[a].toString():"")):t.createElement("div",{style:o},n[a]?n[a].toString():""))}))}))))},n}(t.Component);var _=function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},e(t,n)};return function(t,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function a(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(a.prototype=n.prototype,new a)}}();const h=function(e){function r(){return null!==e&&e.apply(this,arguments)||this}return _(r,e),r.prototype.render=function(){var e=t.createElement(m,{context:this.context,listTitle:this.properties.listTitle,columns:this.properties.columns,mode:this.properties.mode});n.render(e,this.domElement)},r.prototype.onDispose=function(){n.unmountComponentAtNode(this.domElement)},Object.defineProperty(r.prototype,"dataVersion",{get:function(){return a.Version.parse("1.0")},enumerable:!1,configurable:!0}),r.prototype.getPropertyPaneConfiguration=function(){return{pages:[{header:{description:"Configure My Documents / Published Viewer"},groups:[{groupName:"Settings",groupFields:[(0,i.PropertyPaneTextField)("listTitle",{label:"Library Name (e.g., KMartifacts)"}),(0,i.PropertyPaneTextField)("columns",{label:"Columns (comma-separated, e.g., Title,Status,Modified)"}),(0,i.PropertyPaneDropdown)("mode",{label:"Select Mode",options:[{key:"myDocuments",text:"My Documents"},{key:"published",text:"Published"}]})]}]}]}},r}(r.BaseClientSideWebPart)})(),d})());